Sarah Wood
SQL

Assignment #10


1. 

SELECT I.FIRST_NAME||' '|| I.LAST_NAME AS NAME, DECODE(COUNT(DISTINCT SCT.SECTION_ID), 0, 'NULL', COUNT(DISTINCT SCT.SECTION_ID)) AS "SECTIONS"
FROM SECTION SCT, INSTRUCTOR I
WHERE I.INSTRUCTOR_ID = SCT.INSTRUCTOR_ID(+)
GROUP BY I.FIRST_NAME, I.LAST_NAME
ORDER BY NAME;


2.

SELECT COURSE_NO, DESCRIPTION
FROM COURSE

INTERSECT
SELECT DISTINCT SCT.COURSE_NO, C.DESCRIPTION
FROM COURSE C, SECTION SCT, GRADE G
WHERE C.COURSE_NO = SCT.COURSE_NO
AND SCT.SECTION_ID = G.SECTION_ID
AND G.GRADE_TYPE_CODE = 'FI'

INTERSECT
SELECT DISTINCT SCT.COURSE_NO, C.DESCRIPTION
FROM COURSE C, SECTION SCT, GRADE G
WHERE C.COURSE_NO = SCT.COURSE_NO
AND SCT.SECTION_ID = G.SECTION_ID
AND G.GRADE_TYPE_CODE = 'HM'

INTERSECT
SELECT DISTINCT SCT.COURSE_NO, C.DESCRIPTION
FROM COURSE C, SECTION SCT, GRADE G
WHERE C.COURSE_NO = SCT.COURSE_NO
AND SCT.SECTION_ID = G.SECTION_ID
AND G.GRADE_TYPE_CODE = 'MT'

INTERSECT
SELECT DISTINCT SCT.COURSE_NO, C.DESCRIPTION
FROM COURSE C, SECTION SCT, GRADE G
WHERE C.COURSE_NO = SCT.COURSE_NO
AND SCT.SECTION_ID = G.SECTION_ID
AND G.GRADE_TYPE_CODE = 'PA'

INTERSECT
SELECT DISTINCT SCT.COURSE_NO, C.DESCRIPTION
FROM COURSE C, SECTION SCT, GRADE G
WHERE C.COURSE_NO = SCT.COURSE_NO
AND SCT.SECTION_ID = G.SECTION_ID
AND G.GRADE_TYPE_CODE = 'PJ'

INTERSECT
SELECT DISTINCT SCT.COURSE_NO, C.DESCRIPTION
FROM COURSE C, SECTION SCT, GRADE G
WHERE C.COURSE_NO = SCT.COURSE_NO
AND SCT.SECTION_ID = G.SECTION_ID
AND G.GRADE_TYPE_CODE = 'QZ'

ORDER BY COURSE_NO;

3.

SELECT Z.ZIP, COUNT(DISTINCT E.STUDENT_ID) AS "NO OF STUDENTS"
FROM ZIPCODE Z FULL OUTER JOIN STUDENT ST
ON Z.ZIP = ST.ZIP
LEFT OUTER JOIN ENROLLMENT E
ON ST.STUDENT_ID = E.STUDENT_ID
WHERE CITY = 'Astoria'
AND STATE = 'NY'
GROUP BY Z.ZIP
ORDER BY Z.ZIP;

4.
SELECT C.COURSE_NO, C.DESCRIPTION, COUNT(DISTINCT E.STUDENT_ID) "TOTAL ENROLLMENTS"
FROM COURSE C LEFT OUTER JOIN SECTION SCT
ON C.COURSE_NO = SCT.COURSE_NO
FULL OUTER JOIN ENROLLMENT E
ON SCT.SECTION_ID = E.SECTION_ID

WHERE INSTR(C.DESCRIPTION, 'Java') > 0
GROUP BY C.COURSE_NO, C.DESCRIPTION
ORDER BY C.COURSE_NO;

5.
SELECT ST.STUDENT_ID, ST.FIRST_NAME||' '|| ST.LAST_NAME "Nmae", DECODE(COUNT(E.SECTION_ID), 0, 'none', COUNT(E.SECTION_ID)) AS "Enrollment"
FROM ZIPCODE Z LEFT OUTER JOIN STUDENT ST
ON ST.ZIP = Z.ZIP
FULL OUTER JOIN ENROLLMENT E
ON E.STUDENT_ID = ST.STUDENT_ID
WHERE PHONE LIKE '212%'
GROUP BY ST.FIRST_NAME, ST.LAST_NAME, ST.STUDENT_ID
ORDER BY ST.LAST_NAME, ST.FIRST_NAME;




